# -*- coding: utf-8 -*-
"""
Created on Tue Oct 26 20:31:34 2021

@author: willi
"""
import os
cwd = os.getcwd()
os.chdir('../../..')

import rsnapsim as rss
from rsnapsim import seqmanip

import numpy as np
import time
import matplotlib.pyplot as plt

os.chdir(cwd)


import matplotlib.pyplot as plt
from cycler import cycler
########################################
dark = False
if not dark:
    colors = ['#ef476f', '#073b4c','#06d6a0','#7400b8','#073b4c', '#118ab2',]
else:
    plt.style.use('dark_background')
    colors = ['#57ffcd', '#118ab2', '#ff479d', '#ffe869','#ff8c00','#04756f']

font = {'family' : 'normal',
        'weight' : 'bold',
        'size'   : 12}

save = False

plt.rcParams.update({'font.size': 12, 'font.weight':'bold','font.family':'normal'  }   )
plt.rcParams.update({'axes.prop_cycle':cycler(color=colors)})

plt.rcParams.update({'axes.prop_cycle':cycler(color=colors)})
plt.rcParams.update({'axes.prop_cycle':cycler(color=colors)})


plt.rcParams.update({'xtick.major.width'   : 2.8 })
plt.rcParams.update({'xtick.labelsize'   : 12 })



plt.rcParams.update({'ytick.major.width'   : 2.8 })
plt.rcParams.update({'ytick.labelsize'   : 12})

plt.rcParams.update({'axes.titleweight'   : 'bold'})
plt.rcParams.update({'axes.titlesize'   : 10})
plt.rcParams.update({'axes.labelweight'   : 'bold'})
plt.rcParams.update({'axes.labelsize'   : 12})

plt.rcParams.update({'axes.linewidth':2.8})
plt.rcParams.update({'axes.labelpad':8})
plt.rcParams.update({'axes.titlepad':10})
plt.rcParams.update({'figure.dpi':300})

##########################################


suntag_kif = '''atgataataGCTAGCTCTGGAGGAGAAGAACTTTTGAGCAAGAATTATCATCTTGAGAACGAAGTGGCTCGTCTTAAGAAAGGTTCTGGCAGTGGAGAAGAACTGCTTTCAAAGAATTACCACCTGGAAAATGAGGTAGCTAGACTGAAAAAGGGGAGCGGAAGTGGGGAGGAGTTGCTGAGCAAAAATTATCATTTGGAGAACGAAGTAGCACGACTAAAGAAAGGGTCCGGATCGGGTGAGGAGTTACTCTCGAAAAATTATCATCTCGAAAACGAAGTGGCTCGGCTAAAAAAGGGCAGTGGTTCTGGAGAAGAGCTATTATCTAAAAACTACCACCTCGAAAATGAGGTGGCACGCTTAAAAAAGGGAAGTGGCAGTGGTGAAGAGCTACTATCCAAGAATTATCATCTTGAGAACGAGGTAGCGCGTTTGAAGAAGGGTTCCGGCTCAGGAGAGGAACTGCTCTCGAAGAACTATCATCTTGAAAATGAGGTCGCTCGATTAAAAAAGGGATCGGGCAGTGGTGAGGAACTACTTTCAAAGAATTACCACCTCGAAAACGAAGTAGCTCGATTAAAGAAAGGTTCAGGGTCGGGTGAAGAATTACTGAGTAAAAATTATCATCTGGAAAATGAGGTAGCGAGACTAAAAAAGGGGAGTGGTTCTGGCGAAGAGTTGCTATCGAAAAATTATCATCTTGAGAACGAAGTTGCTAGGCTCAAAAAGGGCTCAGGCTCAGGCGAGGAGTTGCTCTCGAAAAACTACCACTTGGAAAATGAGGTCGCGAGGTTGAAAAAGGGGAGCGGGTCGGGCGAGGAGTTATTGAGCAAAAACTATCATTTAGAGAACGAAGTCGCGCGCTTAAAGAAAGGCTCGGGCTCGGGCGAAGAACTCTTATCGAAGAACTACCACCTCGAAAATGAGGTCGCCAGGTTGAAAAAGGGCAGTGGCAGCGGGGAGGAACTCTTGAGCAAGAACTACCACTTGGAGAATGAGGTCGCGAGATTGAAGAAAGGGTCGGGGAGCGGCGAGGAATTGCTCAGCAAGAATTATCATTTGGAGAACGAAGTCGCCAGGCTCAAGAAAGGCTCGGGGTCGGGGGAGGAATTGTTGAGTAAAAACTACCACTTGGAAAATGAAGTCGCCAGGCTCAAAAAAGGGAGTGGGAGCGGCGAAGAGTTATTGAGCAAAAATTACCACTTGGAGAACGAAGTGGCAAGGCTCAAGAAAGGGAGCGGCAGCGGGGAGGAGCTCTTATCGAAGAACTACCACTTAGAGAATGAAGTCGCCCGCTTGAAGAAAGGCTCGGGGAGCGGGGAAGAGCTCTTGAGCAAGAACTACCACTTGGAAAATGAGGTGGCGCGCTTGAAGAAAGGGAGCGGGAGCGGGGAAGAGTTACTATCTAAGAATTATCATCTCGAGAACGAGGTGGCTCGACTAAAGAAGGGCTCCGGCAGTGGGGAGGAACTCCTGTCGAAGAACTATCATCTTGAAAATGAGGTTGCAAGACTTAAAAAGGGGTCCGGATCAGGTGAGGAACTACTCAGTAAGAATTACCACCTGGAAAACGAAGTTGCACGTTTGAAGAAAGGATCAGGATCAGGCGAAGAACTGCTCTCAAAAGATTATCATTTGGAAAATGAGGTTGCACGTTTAAAAAAGGGAAGTGGCAGTGGTGAGGAACTTCTGTCGAAAAATTATCATCTCGAGAATGAAGTAGCCCGACTTAAAAAGGGTTCTGGCTCGGGTCAGCGGCCGCACCGGTCAGCAGTGGAGGACAGCACGCTGCAAGTAGTGGTACGGGTGCGGCCCCCCACCCCTCGGGAGCTGGACAGTCAGCGGCGGCCAGTGGTTCAGGTGGTGGACGAGCGGGTGCTGGTGTTTAACCCTGAGGAGCCCGATGGAGGGTTCCCTGGCCTGAAATGGGGTGGCACCCATGATGGCCCCAAGAAGAAGGGCAAAGACCTGACGTTTGTCTTTGACCGGGTCTTTGGCGAGGCGGCCACCCAACAGGACGTGTTCCAGCACACCACGCACAGCGTCCTGGACAGCTTCCTCCAGGGCTACAACTGCTCAGTGTTTGCCTACGGGGCCACCGGGGCTGGGAAGACACACACCATGCTGGGAAGGGAGGGGGACCCCGGCATCATGTACCTGACCACCGTGGAACTGTACAGGCGCCTGGAGGCCCGCCAGCAGGAGAAGCACTTCGAGGTGCTCATCAGCTACCAGGAGGTGTATAATGAACAGATCCATGACCTCCTGGAGCCCAAGGGGCCCCTTGCCATCCGCGAGGACCCCGACAAGGGGGTGGTGGTGCAAGGACTTTCTTTCCACCAGCCAGCCTCAGCCGAGCAGCTGCTGGAGATACTGACCAGGGGGAACCGTAACCGCACGCAGCACCCCACTGATGCCAACGCGACTTCCTCCCGCTCCCATGCCATCTTCCAGATCTTTGTGAAGCAGCAGGACCGGGTTCCAGGACTGACCCAGGCTGTCCAGGTGGCCAAGATGAGCCTGATTGACCTGGCTGGCTCAGAGCGGGCATCCAGCACCCATGCGAAGGGGGAGCGGCTGCGGGAGGGGGCCAACATCAACCGCTCTCTGCTGGCGCTCATCAACGTCCTCAATGCCTTGGCCGATGCAAAGGGCCGCAAGACCGCTGTGCCCTACGCGGACAGCGCACTGACCCGCCTGCTCAAAGACTCCCTCGGGGGCAACTGCCGCACAGTGATGATCGCTGCCATCAGCCCCTCCAGCCTGACCTACGAGGACACGTATAATACCCTCAAATATGCCGACCGGGCCAAGGAGATCAGGCTCTCGCTGAAGAGCAATGTGACCAGCCTGGACTGTCACATCAGCCAGTATGCTACCATCTGCCAACAGCTCCAGGCTGAGGTAGCCGCTCTGAGGAAGAAGCTCCAAGTGTATGAGGGGGGAGGCCAGCCCCCACCACAGGACCTCCCAGGATCTCCCAAGTCGGGACCACCACCAGAACACCTTCCCAGCTCCCCCTTGCCACCCCACCCTCCCAGCCAGCCCTGCACCCCAGAGCTCCCTGCAGGGCCTAGAGCCCTTCAAGAGGAGAGTCTGGGGATGGAGGCCCAGGTGGAGAGGGCCATGGAAGGGAACTCTTCAGACCAGGAGCAGTCCCCAGAGGATGAGGATGAAGGCCCAGCTGAGGAGGTTCCAACCCAGATGCCAGAGCAGAACCCCACACATGCACTGCCAGAGTCCCCTCGCCTGACCCTGCAGCCCAAGCCAGTCGTGGGCCACTTCTCAGCACGGGAACTGGATGGGGACCGTTCTAAGCGGTTGGCCCTAAAGGTGCTGTGCGTTGCCCAGCGGCAGTACTCCCTGCTCCAAGCAGCCAACCTCCTGACGCCCGACATGATCACAGAGTTTGAGACCCTACAGCAGCTGGTGCAAGAGGAAAAAATTGAGCCTGGGGCAGAGGCCTTGAGGACTTCAGGCCTGGCCAGGGGGGCACCTCTGGCTCAGGAGCTGTGTTCAGAGTCAAAGCCTCCAGGATACACTGGCCCTGTGACCCGGACTATGGCGAGGCGACTGAGTGGCCCCCTGCACACCCTGGGAATCCCGCCTGGACCCAACTGCACCCCAGCCCAGGGGTCCCGATGGCCCATGGAGAAGAAGAGGAGGAGACCAAGCGCCTTGGAGGCAGACAGTCCCATGGCCCCAAAGCGGGGCACCAAGCGCCAGCGCCAGTCCTTCCTGCCCTGCCTAAGGAGAGGGTCTCTGCCTGACACCCAACCTTCACAGGGGCCCAGCACCCCCAAAGGAGAAAGGGCCTCCTCCCCCTGCCATTCCCCTCGCGTTTGCCCAGCCACAGTCATCAAAAGCCGGGTGCCCCTGGGCCCTTCCGCCATGCAGAACTGCTCCACCCCGCTGGCTCTGCCCACTCGAGACCTCAATGCCACCTTTGATCTCTCTGAGGAGCCTCCCTCAAAGCCCAGTTTCCATGAATGCATTGGCTGGGACAAAATACCCCAGGAGCTGAGCAGGCTGGACCAGCCCTTCATCCCCAGGGCACCTGTGCCCCTGTTCACCATGAAGGGCCCCAAGCCAACATCTTCCCTCCCTGGGACCTCTGCCTGCAAGAAGAAGCGCGTTGCGAGTTCCTCAGTCTCCCATGGCCGCAGCCGCATCGCCCGCCTCCCCAGCAGCACTTTGAAGAGGCCAGCTGGGCCCCTTGTACTCCCAGAGCTGCCCTTGAGTCCCCTGTGCCCTAGCAACCGGAGGAATGGAAAGGACCTCATCAGGGTGGGGAGAGCACTCTCAGCAGGGAACGGCGTCACCAAGGTGTCCGATAAGGACCTAGGCGGACTGTTACTGAGCTGCGTTTTACACCCTTTCTTTGACAAAACCTAA'''
bactin_seq = '''ATGGACTACAAGGACGACGACGACAAAGGTGACTACAAAGATGATGACGATAAAGGCGACTATAAGGACGATGACGACAAGGGCGGAAACTCACTGATCAAGGAAAACATGCGGATGAAGGTGGTGATGGAGGGCTCCGTGAATGGTCACCAGTTCAAGTGCACCGGAGAGGGAGAGGGAAACCCGTACATGGGAACTCAGACCATGCGCATTAAGGTCATCGAAGGAGGTCCGCTGCCGTTCGCTTTCGATATCCTGGCCACTTCGTTCGGAGGAGGGTCGCGCACGTTCATCAAGTACCCGAAGGGAATCCCGGACTTCTTTAAGCAGTCATTCCCGGAAGGATTCACTTGGGAACGGGTGACCCGGTATGAAGATGGAGGTGTGGTGACTGTCATGCAAGATACTTCGCTGGAGGATGGGTGCCTCGTGTACCACGTCCAAGTCCGCGGAGTGAATTTCCCGTCCAACGGACCAGTGATGCAGAAAAAGACGAAGGGTTGGGAACCTAATACTGAAATGATGTACCCCGCAGACGGAGGGCTGAGGGGCTACACCCACATGGCGCTGAAGGTCGACGGAGGAGATTACAAGGATGACGACGATAAGCAACAAGATTACAAAGACGATGATGACAAGGGCCAGCAGGGCGACTACAAGGACGACGACGACAAGCAGCAGGACTACAAAGATGACGATGATAAAGGAGGAGGACATCTGTCCTGTTCGTTCGTGACCACCTACAGATCAAAGAAAACCGTGGGAAACATCAAGATGCCGGGCATTCATGCCGTCGACCACCGCCTGGAGCGGCTCGAAGAATCAGACAATGAGATGTTCGTCGTGCAAAGAGAACATGCCGTGGCCAAGTTCGCGGGACTGGGAGGCGGTGGAGGCGATTACAAAGACGATGATGACAAGGGTGACTATAAAGACGACGATGACAAAGGGGATTACAAGGATGATGATGATAAGGGAGGCGGTGGATCAGGTGGAGGAGGTTCACTGCAGGATGATGATATCGCCGCGCTCGTCGTCGACAACGGCTCCGGCATGTGCAAGGCCGGCTTCGCGGGCGACGATGCCCCCCGGGCCGTCTTCCCCTCCATCGTGGGGCGCCCCAGGCACCAGGGCGTGATGGTGGGCATGGGTCAGAAGGATTCCTATGTGGGCGACGAGGCCCAGAGCAAGAGAGGCATCCTCACCCTGAAGTACCCCATCGAGCACGGCATCGTCACCAACTGGGACGACATGGAGAAAATCTGGCACCACACCTTCTACAATGAGCTGCGTGTGGCTCCCGAGGAGCACCCCGTGCTGCTGACCGAGGCCCCCCTGAACCCCAAGGCCAACCGCGAGAAGATGACCCAGATCATGTTTGAGACCTTCAACACCCCAGCCATGTACGTTGCTATCCAGGCTGTGCTATCCCTGTACGCCTCTGGCCGTACCACTGGCATCGTGATGGACTCCGGTGACGGGGTCACCCACACTGTGCCCATCTACGAGGGGTATGCCCTCCCCCATGCCATCCTGCGTCTGGACCTGGCTGGCCGGGACCTGACTGACTACCTCATGAAGATCCTCACCGAGCGCGGCTACAGCTTCACCACCACGGCCGAGCGGGAAATCGTGCGTGACATTAAGGAGAAGCTGTGCTACGTCGCCCTGGACTTCGAGCAAGAGATGGCCACGGCTGCTTCCAGCTCCTCCCTGGAGAAGAGCTACGAGCTGCCTGACGGCCAGGTCATCACCATTGGCAATGAGCGGTTCCGCTGCCCTGAGGCACTCTTCCAGCCTTCCTTCCTGGGCATGGAGTCCTGTGGCATCCACGAAACTACCTTCAACTCCATCATGAAGTGTGACGTGGACATCCGCAAAGACCTGTACGCCAACACAGTGCTGTCTGGCGGCACCACCATGTACCCTGGCATTGCCGACAGGATGCAGAAGGAGATCACTGCCCTGGCACCCAGCACAATGAAGATCAAGATCATTGCTCCTCCTGAGCGCAAGTACTCCGTGTGGATCGGCGGCTCCATCCTGGCCTCGCTGTCCACCTTCCAGCAGATGTGGATCAGCAAGCAGGAGTATGACGAGTCCGGCCCCTCCATCGTCCACCGCAAATGCTTCTAG'''
#the original suntag_kif has 24x Epitopes, so we are going to manually delete 14 of them with this sequence:
suntags_todelete = 'GSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGEELLSKDYHLENEVARLKKGSGSGEELLSKNYHLENEVARLKKGSGSGQ'

hairpin = 'ACGUGCCACGAUUCAACGUGGCACAGC'
bactin_only = bactin_seq[337*3:] #getting just B-actin
suntag = suntag_kif[:591*3] #deleting KIF
suntag = suntag[:729] + suntag[1737:] #deleting 14x Suntag epitopes
flagtag = bactin_seq[:337*3] #getting just the Flag tag 

bactin_codons = [bactin_only[i:i+3] for i in range(0, len(bactin_only), 3)]  #convert b-actin to pairs of codons
suntag_codons = [suntag[i:i+3] for i in range(0, len(suntag), 3)] #suntag codons
flagtag_codons = [flagtag[i:i+3] for i in range(0, len(flagtag), 3)] #flagtag codons
hairpin_codons = [hairpin[i:i+3] for i in range(0, len(hairpin), 3)] #hairpin codons

construct1 = flagtag_codons + suntag_codons + bactin_codons 
construct_sequence_str1 = ''.join(construct1)

construct2 = flagtag_codons + bactin_codons[:-1] + suntag_codons + ['TGA',]
construct_sequence_str2 = ''.join(construct2)


bactin_1 = rss.seqmanip.seq_to_protein_obj(construct_sequence_str1,add_tag=False)['1'][0]
bactin_2 = rss.seqmanip.seq_to_protein_obj(construct_sequence_str2,add_tag=False)['1'][0]

t = np.linspace(0,2000,2000)
bactin_soln1 = rss.solver.solve_ssa(bactin_1.kelong,t, ki=.023, n_traj=1,low_memory=False, probe_vec= bactin_1.probe_vec, probe_loc = bactin_1.probe_loc )
bactin_soln2 = rss.solver.solve_ssa(bactin_2.kelong,t, ki=.023, n_traj=1,low_memory=False, probe_vec= bactin_2.probe_vec, probe_loc = bactin_2.probe_loc )

plt.figure()

base_mw = rss.diffcalc.calculate_rna_strand_base_mw(bactin_1.nt_seq + 'A'*100, )
mw_tensor = rss.diffcalc.mw_over_time(bactin_soln1.ribosome_locations, bactin_1.nt_seq, bactin_1.probe_loc, base_mw, fluorophore=['Cy3','GFP' ] )
D_tensor = rss.diffcalc.calculate_diffusion_constant(mw_tensor)

f,ax = plt.subplots(3,1, tight_layout=True)
ax[1].semilogy(mw_tensor[0])
ax[0].plot(bactin_soln1.intensity_vec[:,:,0].T/10)
ax[2].plot(D_tensor[0])

ax[2].set_xlabel('Time')

ax[0].set_ylabel('Int (UMP)')
ax[1].set_ylabel('MW (Da)')
ax[2].set_ylabel(r'$D$ ($\frac{\mu m^2}{s}$)')
plt.savefig('diff_calc.png')









amanda_IRES = '''atgataataGCTAGCTCTGGAGGAGAAGAACTTTTGAGCAAGAATTATCATCTTGAGAACGAAGTGGCTCGTCTTAAGAAAGGTTCTGGCAGTGGAGAAGAACTGCTTTCAAAGAATTACCACCTGGAAAATGAGGTAGCTAGACTGAAAAAGGGGAGCGGAAGTGGGGAGGAGTTGCTGAGCAAAAATTATCATTTGGAGAACGAAGTAGCACGACTAAAGAAAGGGTCCGGATCGGGTGAGGAGTTACTCTCGAAAAATTATCATCTCGAAAACGAAGTGGCTCGGCTAAAAAAGGGCAGTGGTTCTGGAGAAGAGCTATTATCTAAAAACTACCACCTCGAAAATGAGGTGGCACGCTTAAAAAAGGGAAGTGGCAGTGGTGAAGAGCTACTATCCAAGAATTATCATCTTGAGAACGAGGTAGCGCGTTTGAAGAAGGGTTCCGGCTCAGGAGAGGAACTGCTCTCGAAGAACTATCATCTTGAAAATGAGGTCGCTCGATTAAAAAAGGGATCGGGCAGTGGTGAGGAACTACTTTCAAAGAATTACCACCTCGAAAACGAAGTAGCTCGATTAAAGAAAGGTTCAGGGTCGGGTGAAGAATTACTGAGTAAAAATTATCATCTGGAAAATGAGGTAGCGAGACTAAAAAAGGGGAGTGGTTCTGGCGAAGAGTTGCTATCGAAAAATTATCATCTTGAGAACGAAGTTGCTAGGCTCAAAAAGGGCTCAGGCTCAGGCGAGGAGTTGCTCTCGAAAAACTACCACTTGGAAAATGAGGTCGCGAGGTTGAAAAAGGGGAGCGGGTCGGGCGAGGAGTTATTGAGCAAAAACTATCATTTAGAGAACGAAGTCGCGCGCTTAAAGAAAGGCTCGGGCTCGGGCGAAGAACTCTTATCGAAGAACTACCACCTCGAAAATGAGGTCGCCAGGTTGAAAAAGGGCAGTGGCAGCGGGGAGGAACTCTTGAGCAAGAACTACCACTTGGAGAATGAGGTCGCGAGATTGAAGAAAGGGTCGGGGAGCGGCGAGGAATTGCTCAGCAAGAATTATCATTTGGAGAACGAAGTCGCCAGGCTCAAGAAAGGCTCGGGGTCGGGGGAGGAATTGTTGAGTAAAAACTACCACTTGGAAAATGAAGTCGCCAGGCTCAAAAAAGGGAGTGGGAGCGGCGAAGAGTTATTGAGCAAAAATTACCACTTGGAGAACGAAGTGGCAAGGCTCAAGAAAGGGAGCGGCAGCGGGGAGGAGCTCTTATCGAAGAACTACCACTTAGAGAATGAAGTCGCCCGCTTGAAGAAAGGCTCGGGGAGCGGGGAAGAGCTCTTGAGCAAGAACTACCACTTGGAAAATGAGGTGGCGCGCTTGAAGAAAGGGAGCGGGAGCGGGGAAGAGTTACTATCTAAGAATTATCATCTCGAGAACGAGGTGGCTCGACTAAAGAAGGGCTCCGGCAGTGGGGAGGAACTCCTGTCGAAGAACTATCATCTTGAAAATGAGGTTGCAAGACTTAAAAAGGGGTCCGGATCAGGTGAGGAACTACTCAGTAAGAATTACCACCTGGAAAACGAAGTTGCACGTTTGAAGAAAGGATCAGGATCAGGCGAAGAACTGCTCTCAAAAGATTATCATTTGGAAAATGAGGTTGCACGTTTAAAAAAGGGAAGTGGCAGTGGTGAGGAACTTCTGTCGAAAAATTATCATCTCGAGAATGAAGTAGCCCGACTTAAAAAGGGTTCTGGCTCGGGTCAGCGGCCGCACCGGTCAGCAGTGGAGGACAGCACGCTGCAAGTAGTGGTACGGGTGCGGCCCCCCACCCCTCGGGAGCTGGACAGTCAGCGGCGGCCAGTGGTTCAGGTGGTGGACGAGCGGGTGCTGGTGTTTAACCCTGAGGAGCCCGATGGAGGGTTCCCTGGCCTGAAATGGGGTGGCACCCATGATGGCCCCAAGAAGAAGGGCAAAGACCTGACGTTTGTCTTTGACCGGGTCTTTGGCGAGGCGGCCACCCAACAGGACGTGTTCCAGCACACCACGCACAGCGTCCTGGACAGCTTCCTCCAGGGCTACAACTGCTCAGTGTTTGCCTACGGGGCCACCGGGGCTGGGAAGACACACACCATGCTGGGAAGGGAGGGGGACCCCGGCATCATGTACCTGACCACCGTGGAACTGTACAGGCGCCTGGAGGCCCGCCAGCAGGAGAAGCACTTCGAGGTGCTCATCAGCTACCAGGAGGTGTATAATGAACAGATCCATGACCTCCTGGAGCCCAAGGGGCCCCTTGCCATCCGCGAGGACCCCGACAAGGGGGTGGTGGTGCAAGGACTTTCTTTCCACCAGCCAGCCTCAGCCGAGCAGCTGCTGGAGATACTGACCAGGGGGAACCGTAACCGCACGCAGCACCCCACTGATGCCAACGCGACTTCCTCCCGCTCCCATGCCATCTTCCAGATCTTTGTGAAGCAGCAGGACCGGGTTCCAGGACTGACCCAGGCTGTCCAGGTGGCCAAGATGAGCCTGATTGACCTGGCTGGCTCAGAGCGGGCATCCAGCACCCATGCGAAGGGGGAGCGGCTGCGGGAGGGGGCCAACATCAACCGCTCTCTGCTGGCGCTCATCAACGTCCTCAATGCCTTGGCCGATGCAAAGGGCCGCAAGACCGCTGTGCCCTACGCGGACAGCGCACTGACCCGCCTGCTCAAAGACTCCCTCGGGGGCAACTGCCGCACAGTGATGATCGCTGCCATCAGCCCCTCCAGCCTGACCTACGAGGACACGTATAATACCCTCAAATATGCCGACCGGGCCAAGGAGATCAGGCTCTCGCTGAAGAGCAATGTGACCAGCCTGGACTGTCACATCAGCCAGTATGCTACCATCTGCCAACAGCTCCAGGCTGAGGTAGCCGCTCTGAGGAAGAAGCTCCAAGTGTATGAGGGGGGAGGCCAGCCCCCACCACAGGACCTCCCAGGATCTCCCAAGTCGGGACCACCACCAGAACACCTTCCCAGCTCCCCCTTGCCACCCCACCCTCCCAGCCAGCCCTGCACCCCAGAGCTCCCTGCAGGGCCTAGAGCCCTTCAAGAGGAGAGTCTGGGGATGGAGGCCCAGGTGGAGAGGGCCATGGAAGGGAACTCTTCAGACCAGGAGCAGTCCCCAGAGGATGAGGATGAAGGCCCAGCTGAGGAGGTTCCAACCCAGATGCCAGAGCAGAACCCCACACATGCACTGCCAGAGTCCCCTCGCCTGACCCTGCAGCCCAAGCCAGTCGTGGGCCACTTCTCAGCACGGGAACTGGATGGGGACCGTTCTAAGCGGTTGGCCCTAAAGGTGCTGTGCGTTGCCCAGCGGCAGTACTCCCTGCTCCAAGCAGCCAACCTCCTGACGCCCGACATGATCACAGAGTTTGAGACCCTACAGCAGCTGGTGCAAGAGGAAAAAATTGAGCCTGGGGCAGAGGCCTTGAGGACTTCAGGCCTGGCCAGGGGGGCACCTCTGGCTCAGGAGCTGTGTTCAGAGTCAAAGCCTCCAGGATACACTGGCCCTGTGACCCGGACTATGGCGAGGCGACTGAGTGGCCCCCTGCACACCCTGGGAATCCCGCCTGGACCCAACTGCACCCCAGCCCAGGGGTCCCGATGGCCCATGGAGAAGAAGAGGAGGAGACCAAGCGCCTTGGAGGCAGACAGTCCCATGGCCCCAAAGCGGGGCACCAAGCGCCAGCGCCAGTCCTTCCTGCCCTGCCTAAGGAGAGGGTCTCTGCCTGACACCCAACCTTCACAGGGGCCCAGCACCCCCAAAGGAGAAAGGGCCTCCTCCCCCTGCCATTCCCCTCGCGTTTGCCCAGCCACAGTCATCAAAAGCCGGGTGCCCCTGGGCCCTTCCGCCATGCAGAACTGCTCCACCCCGCTGGCTCTGCCCACTCGAGACCTCAATGCCACCTTTGATCTCTCTGAGGAGCCTCCCTCAAAGCCCAGTTTCCATGAATGCATTGGCTGGGACAAAATACCCCAGGAGCTGAGCAGGCTGGACCAGCCCTTCATCCCCAGGGCACCTGTGCCCCTGTTCACCATGAAGGGCCCCAAGCCAACATCTTCCCTCCCTGGGACCTCTGCCTGCAAGAAGAAGCGCGTTGCGAGTTCCTCAGTCTCCCATGGCCGCAGCCGCATCGCCCGCCTCCCCAGCAGCACTTTGAAGAGGCCAGCTGGGCCCCTTGTACTCCCAGAGCTGCCCTTGAGTCCCCTGTGCCCTAGCAACCGGAGGAATGGAAAGGACCTCATCAGGGTGGGGAGAGCACTCTCAGCAGGGAACGGCGTCACCAAGGTGTCCGATAAGGACCTAGGCGGACTGTTACTGAGCTGCGTTTTACACCCTTTCTTTGACAAAACCTAA'''
amanda_CAP = '''ATGGACTACAAGGACGACGACGACAAAGGTGACTACAAAGATGATGACGATAAAGGCGACTATAAGGACGATGACGACAAGGGCGGAAACTCACTGATCAAGGAAAACATGCGGATGAAGGTGGTGATGGAGGGCTCCGTGAATGGTCACCAGTTCAAGTGCACCGGAGAGGGAGAGGGAAACCCGTACATGGGAACTCAGACCATGCGCATTAAGGTCATCGAAGGAGGTCCGCTGCCGTTCGCTTTCGATATCCTGGCCACTTCGTTCGGAGGAGGGTCGCGCACGTTCATCAAGTACCCGAAGGGAATCCCGGACTTCTTTAAGCAGTCATTCCCGGAAGGATTCACTTGGGAACGGGTGACCCGGTATGAAGATGGAGGTGTGGTGACTGTCATGCAAGATACTTCGCTGGAGGATGGGTGCCTCGTGTACCACGTCCAAGTCCGCGGAGTGAATTTCCCGTCCAACGGACCAGTGATGCAGAAAAAGACGAAGGGTTGGGAACCTAATACTGAAATGATGTACCCCGCAGACGGAGGGCTGAGGGGCTACACCCACATGGCGCTGAAGGTCGACGGAGGAGATTACAAGGATGACGACGATAAGCAACAAGATTACAAAGACGATGATGACAAGGGCCAGCAGGGCGACTACAAGGACGACGACGACAAGCAGCAGGACTACAAAGATGACGATGATAAAGGAGGAGGACATCTGTCCTGTTCGTTCGTGACCACCTACAGATCAAAGAAAACCGTGGGAAACATCAAGATGCCGGGCATTCATGCCGTCGACCACCGCCTGGAGCGGCTCGAAGAATCAGACAATGAGATGTTCGTCGTGCAAAGAGAACATGCCGTGGCCAAGTTCGCGGGACTGGGAGGCGGTGGAGGCGATTACAAAGACGATGATGACAAGGGTGACTATAAAGACGACGATGACAAAGGGGATTACAAGGATGATGATGATAAGGGAGGCGGTGGATCAGGTGGAGGAGGTTCACTGCAGGCGATCGCCATGGAGGCGGCCACCACACTGCACCCAGGCCCGCGCCCGGCGCTGCCCCTCGGGGGCCCGGGCCCGCTGGGCGAGTTCCTGCCTCCACCCGAGTGCCCGGTCTTCGAACCCAGCTGGGAAGAGTTCGCGGACCCCTTCGCTTTCATCCACAAGATCCGGCCCATAGCCGAGCAGACTGGCATCTGTAAGGTGCGGCCGCCGCCGGATTGGCAGCCACCATTTGCATGTGATGTTGATAAACTTCATTTTACGCCACGTATCCAGAGACTGAATGAATTGGAGGCCCAAACTCGTGTAAAATTGAATTTCTTGGACCAGATTGCAAAGTACTGGGAGTTACAGGGAAGTACTCTGAAAATTCCACATGTGGAGAGGAAGATCTTGGACTTATTTCAGCTTAATAAGTTAGTTGCAGAAGAAGGTGGATTTGCAGTTGTTTGCAAGGATAGAAAATGGACCAAAATTGCTACCAAGATGGGGTTTGCTCCTGGCAAAGCAGTGGGCTCACATATCAGAGGGCATTATGAACGAATTCTCAACCCCTACAACTTATTCCTGTCCGGAGACAGCCTAAGGTGTTTGCAGAAGCCAAACCTGACCACAGACACTAAGGACAAGGAGTACAAACCCCATGATATTCCCCAGAGGCAGTCTGTGCAGCCTTCGGAAACGTGCCCCCCAGCCCGACGAGCAAAACGCATGAGAGCAGAGGCCATGAATATTAAAATAGAACCCGAGGAGACAACAGAAGCCAGAACTCATAATCTGAGACGTCGAATGGGTTGTCCAACTCCAAAATGTGAAAATGAGAAAGAAATGAAGAGTAGCATCAAGCAAGAACCTATTGAGAGGAAAGATTATATTGTAGAAAATGAGAAGGAAAAGCCCAAGAGTCGATCTAAAAAAGCCACCAATGCTGTGGACCTGTATGTCTGTCTTTTATGTGGCAGTGGCAATGATGAAGACCGGCTACTGTTGTGTGATGGCTGTGATGACAGTTACCATACCTTTTGCTTGATCCCACCTCTCCATGATGTTCCCAAGGGAGACTGGAGGTGTCCTAAGTGTTTGGCTCAGGAATGTAGTAAGCCACAAGAAGCATTTGGCTTTGAACAAGCAGCCAGGGACTATACCCTCCGTACTTTTGGGGAAATGGCAGATGCGTTCAAATCTGATTACTTCAACATGCCAGTCCATATGGTCCCCACAGAGCTTGTTGAGAAAGAATTTTGGAGACTAGTAAGCACTATTGAGGAGGATGTCACAGTGGAATATGGAGCTGACATTGCCTCAAAGGAATTTGGCAGTGGCTTTCCTGTCCGAGATGGGAAAATCAAACTCTCACCTGAGGAAGAGGAGTATCTTGATAGTGGCTGGAATTTGAACAACATGCCAGTGATGGAGCAGTCTGTCCTTGCACATATTACTGCTGATATATGTGGCATGAAACTTCCTTGGTTGTATGTGGGAATGTGCTTTTCTTCATTCTGTTGGCACATTGAAGACCACTGGAGCTATTCAATTAACTACTTGCACTGGGGTGAGCCAAAAACCTGGTATGGAGTCCCAGGGTATGCTGCTGAGCAGCTAGAAAATGTAATGAAGAAACTAGCTCCAGAACTCTTTGTGTCCCAGCCGGATCTCCTCCATCAGCTTGTGACCATCATGAACCCCAATACCCTGATGACTCATGAAGTGCCTGTTTACCGAACTAATCAGTGTGCTGGGGAGTTTGTGATTACATTTCCAAGAGCCTACCACAGTGGTTTTAACCAGGGTTTTAATTTTGCTGAGGCTGTTAACTTCTGCACTGTTGATTGGCTGCCATTAGGCCGACAGTGTGTGGAGCATTATCGCTTGCTTCATCGATATTGTGTGTTTTCCCACGATGAGATGATCTGCAAGATGGCTTCCAAGGCTGATGTATTAGATGTTGTAGTGGCTTCAACTGTTCAGAAAGACATGGCCATTATGATTGAGGATGAGAAAGCTTTAAGAGAAACTGTCCGTAAATTGGGAGTGATTGATTCGGAAAGAATGGATTTTGAGCTGTTGCCAGATGATGAACGTCAGTGTGTAAAATGCAAAACTACATGCTTCATGTCTGCCATCTCCTGTTCTTGTAAACCTGGCCTTCTTGTTTGCCTGCATCATGTAAAAGAATTGTGTTCCTGTCCTCCTTATAAATATAAATTGCGGTATAGGTACACGCTGGATGATCTCTACCCTATGATGAATGCATTGAAGCTTCGAGCAGAATCTTACAACGAATGGGCCTTGAATGTGAATGAAGCTTTGGAGGCAAAGATCAACAAGAAGAAAAGCCTTGTCAGCTTCAAGGCTTTAATTGAAGAATCTGAAATGAAGAAATTCCCAGACAATGATCTTTTGCGACACCTTCGCCTAGTCACACAGGATGCAGAGAAGTGTGCCTCTGTTGCGCAGCAGTTGCTTAATGGCAAAAGGCAAACTAGATATCGATCTGGTGGAGGGAAATCCCAAAATCAGTTGACAGTGAATGAGCTCCGGCAGTTTGTAACACAGCTGTATGCTCTTCCATGTGTCCTCAGTCAGACACCATTACTAAAGGATCTCTTGAATCGTGTAGAAGATTTTCAACAGCATAGTCAGAAACTACTCTCTGAGGAAACGCCTAGTGCTGCGGAGCTGCAGGACTTGCTAGATGTCAGCTTTGAATTTGATGTTGAACTTCCACAGCTTGCTGAGATGCGTATCCGTTTGGAACAAGCCCGTTGGCTAGAAGAGGTGCAGCAAGCTTGCCTAGACCCCAGCTCCCTTACTTTAGATGATATGAGACGTCTCATAGACCTAGGGGTAGGGCTGGCCCCGTATTCAGCAGTGGAGAAAGCTATGGCCCGGCTGCAGGAACTGCTCACAGTGTCAGAGCACTGGGACGACAAAGCCAAGAGTCTCCTCAAGGCCAGGCCACGACATTCATTGAATAGCCTTGCTACGGCAGTAAAGGAAATCGAAGAGATCCCTGCATATCTGCCCAATGGTGCGGCTCTGAAAGACTCAGTGCAGAGAGCCAGAGACTGGCTTCAGGATGTAGAGGGCCTGCAGGCTGGAGGACGTGTGCCAGTGTTAGACACACTCATAGAACTTGTTACACGAGGCCGATCTATCCCGGTACATCTGAATTCTTTGCCAAGACTGGAAACCCTAGTAGCTGAGGTTCAGGCTTGGAAAGAATGTGCTGTTAATACATTCTTGACTGAGAATTCTCCATATTCTCTCTTAGAGGTGCTGTGTCCTCGATGTGATATTGGCCTTTTGGGATTGAAAAGGAAGCAGAGAAAGTTAAAGGAGCCCTTGCCAAATGGAAAGAAAAAAAGCACCAAATTAGAGAGTCTGAGTGACCTGGAGAGAGCTTTAACTGAAAGCAAGGAGACTGCTTCAGCTATGGCAACTCTTGGGGAAGCTCGCCTAAGGGAAATGGAAGCCTTGCAGTCTCTCAGACTCGCCAATGAAGGGAAATTGCTGTCGCCTCTCCAAGATGTGGATATAAAAATCTGCCTATGTCAGAAGGCCCCAGCTGCCCCTATGATTCAATGTGAACTCTGCAGGGATGCTTTCCACACCAGTTGTGTGGCGGTACCCAGTATTTCACAGGGCCTGCGAATCTGGCTTTGTCCCCATTGTCGGAGGTCAGAGAAACCTCCATTAGAGAAAATTCTGCCCCTGCTCGCCTCCCTTCAGCGTATCCGAGTTCGCCTTCCTGAGGGAGATGCACTTCGATATATGATTGAAAGAACCGTGAACTGGCAGCACAGAGCCCAGCAACTGCTTTCGTCAGGGAATCTTAAATTTGTGCAAGATCGAGTGGGCTCAGGACTGTTATATAGCAGATGGCAAGCCTCAGCAGGACAGGTGTCAGACACAAACAAGGTATCTCAACCTCCTGGCACAACATCATTTTCTTTGCCTGATGACTGGGACAACAGAACCTCATATTTGCACTCCCCCTTCTCAACTGGACGAAGTTGTATCCCCCTCCATGGTGTTAGTCCAGAAGTGAATGAACTATTGATGGAAGCCCAGCTGCTCCAGGTATCCCTTCCTGAAATTCAGGAACTTTACCAGACTTTACTTGCAAAGCCAAGCCCTGCTCAGCAGACTGACCGAAGCTCACCAGTGAGACCCAGCAGTGAGAAGAATGACTGTTGCCGAGGGAAGCGAGATGGAATTAACAGTCTTGAGAGAAAACTGAAGAGACGCCTGGAAAGAGAGGGCCTCTCCAGTGAGCGGTGGGAACGAGTTAAGAAAATGCGGACCCCCAAAAAGAAGAAAATCAAACTGAGCCACCCCAAGGACATGAACAATTTCAAGTTAGAGAGAGAGCGTAGCTATGAATTAGTTCGTTCTGCTGAAACTCATTCCCTGCCCTCAGACACATCCTATTCCGAACAGGAAGACTCTGAGGATGAAGATGCCATCTGCCCAGCTGTGAGCTGCCTGCAGCCAGAAGGAGATGAGGTGGACTGGGTCCAGTGTGATGGCAGCTGCAATCAGTGGTTTCATCAGGTCTGTGTTGGTGTCTCCCCAGAGATGGCAGAGAAAGAAGACTACATCTGTGTGCGCTGTACTGTGAAGGACGCACCAAGCCGAAAGGTTTAA'''
poi_0 = rss.seqmanip.seq_to_protein_obj(amanda_IRES)
poi_1 = rss.seqmanip.seq_to_protein_obj(amanda_CAP)

cap = poi_1['1'][0]
ires = poi_0['1'][0]


full_construct =amanda_CAP +  amanda_IRES 
kelong = rss.propf.get_k( full_construct, .03, 1.7, 0)[1:-1]
kelong[1885] = 0  # Cap stop codon
kelong[-1] = 0 #IRES stop codon
IRES_start = 1886

k_init_cap = 4.8e-2
k_init_ires = 4.9e-2

k_on_c = 4.8e-4
k_off_c = 2e-3
k_on_i = 1.8e-4
k_off_i = 6.6e-3
k_on_ic = 1.5e-3

kout_cap = 1.7
kout_ires = 1.7

flagtags = cap.tag_epitopes
suntags = ires.tag_epitopes

probe_locations = np.zeros([2,len(kelong)], dtype=np.intc  )
probe_locations[0,flagtags['T_Flag']] = 1
probe_locations[1,np.array([suntags['T_SunTag']]) + IRES_start   ] = 1
aa_seq_IRES = rss.seqmanip.nt2aa(amanda_IRES)  #IRES amino_acid seq
aa_seq_CAP = rss.seqmanip.nt2aa(amanda_CAP) #CAP amino_acid seq
#Whats the MW change per position as a ribosome translates? Including tags/fluorphores
aa_mw_vec_IRES = rss.diffcalc.calculate_single_rib_mw(aa_seq_IRES, probe_locations[1][len(aa_seq_CAP):],fluorophore= 'GFP')
aa_mw_vec_CAP = rss.diffcalc.calculate_single_rib_mw(aa_seq_CAP, probe_locations[0][0:len(aa_seq_CAP)],fluorophore= 'cy3')
